<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dev.toyproject.foodDelivery.mapper.coupon.CouponMapper">

    <select id="findCouponEnable" parameterType="String" resultType="dev.toyproject.foodDelivery.coupon.domain.Coupon">
        SELECT COUPON_TOKEN
             , SHOP_TOKEN
             , DISCOUNT_PRICE
             , END_DATE
             , EXPIRATION_PERIOD
          FROM coupon
         WHERE 1=1
           AND SHOP_TOKEN = #{shopToken}
           AND END_DATE <![CDATA[ > ]]> SYSDATE()
            OR EXPIRATION_PERIOD != 0
           AND STATUS = 'ENABLE'
    </select>

</mapper>